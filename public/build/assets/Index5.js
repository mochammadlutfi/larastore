import{h as b}from"./moment.js";import{_ as D,L as P,o as l,B as u,C as t,a as e,b as _,G as i,D as c,c as k,E as C,F as w,e as p,H as S,a5 as d,a6 as T}from"./id.js";import{E as g}from"./index21.js";import{E as M}from"./index30.js";import{E as L}from"./index22.js";import{E as V}from"./index8.js";import{E as z}from"./index9.js";import{E as N}from"./index31.js";import"./index7.js";import"./typescript.js";import"./index28.js";import"./scroll.js";import"./validator.js";import"./event.js";const Y={data(){return{status:this.route().params.status==null?"unpaid":this.route().params.status,data:[],isLoading:!1,page:1,pageSize:0,total:0,from:0,to:0,searchTerms:""}},async mounted(){await this.fetchData()},methods:{async fetchData(o){var o=o??1;try{this.isLoading=!0;const n=await axios.get(this.route("user.order.data"),{params:{page:o,search:this.searchTerms,status:this.status}});n.status==200&&(this.data=n.data.data,this.page=n.data.current_page,this.total=n.data.total,this.pageSize=n.data.per_page,this.from=n.data.from,this.to=n.data.to),this.isLoading=!1}catch(n){console.error(n)}},format_date(a){if(a)return b.locale("id"),b(String(a)).format("DD MMM YYYY")},payment(a){snap.pay(a.payment_ref,{onSuccess:function(o){this.updatePayment("paid",a.id),g({type:"success",message:"Pembayaran Berhasil"})},onPending:function(o){g({type:"info",message:"Menunggu Pembayaran"})},onError:function(o){g({type:"error",message:"Pembayaran Gagal"})},onClose:function(o){console.log(o)}})},async updatePayment(a,o){try{this.isLoading=!0,(await axios.post(this.route("user.order.state",{id:o}),{status:a})).status==200&&location.reload(),this.isLoading=!1}catch(n){console.error(n)}},receive(a){M.alert("Pastikan barang yang diterima sesuai dengan pesanan!","Peringatan",{showCancelButton:!0,confirmButtonText:"Pesanan Sudah Diterima!",cancelButtonText:"Batal!",type:"warning"}).then(()=>{this.$inertia.post(this.route("user.order.confirm",{id:a}),{preserveScroll:!0,onSuccess:()=>{this.fetchData(),g({type:"success",message:"Pesanan Berhasil Diterima!"})}})})}}},j=e("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e("h3",{class:"fs-4 fw-bold mb-0"},"Pesanan Saya")],-1),F={class:"block block-bordered rounded mb-3"},G={class:"nav nav-tabs nav-tabs-alt nav-fill"},I={class:"nav-item"},q=["href"],H={class:"nav-item"},K=["href"],R={class:"nav-item"},U=["href"],A={class:"nav-item"},J=["href"],O={class:"nav-item"},Q=["href"],W={class:"block-content p-2"},X=e("i",{class:"fa fa-search"},null,-1),Z={class:"d-flex float-end my-auto"},$={class:"my-auto px-3"},ee={class:"pt-25 pl-0"},se=e("i",{class:"fa fa-chevron-left fa-fw"},null,-1),te=e("i",{class:"fa fa-chevron-right fa-fw"},null,-1),ae={class:"block-header border-3x border-bottom p-3"},oe={class:"block-title"},ne={class:"block-options"},re={class:"block-options-item"},ie={class:"block-content p-3"},le=["src"],ce={class:"my-auto"},de={class:"fs-6 fw-bold"},ue={class:"fs-sm fw-semibold"},me={class:"my-auto"},_e=e("div",{class:"fs-6"},"Total Belanja",-1),pe={class:"fs-5 fw-bold"},fe={class:"block-content block-content-full block-content-sm text-right border-top"},he=["href"];function ge(a,o,n,ye,r,y){const x=L,m=V,f=S,v=z,h=N,B=P("user-layout");return l(),u(B,null,{default:t(()=>[j,e("div",F,[e("ul",G,[e("li",I,[e("a",{class:_(["nav-link",{active:r.status=="unpaid"}]),href:a.route("user.order.index",{status:"unpaid"})},"Belum Bayar ",10,q)]),e("li",H,[e("a",{class:_(["nav-link",{active:r.status=="process"}]),href:a.route("user.order.index",{status:"process"})},"Dikemas ",10,K)]),e("li",R,[e("a",{class:_(["nav-link",{active:r.status=="shipped"}]),href:a.route("user.order.index",{status:"shipped"})},"Dikirim ",10,U)]),e("li",A,[e("a",{class:_(["nav-link",{active:r.status=="done"}]),href:a.route("user.order.index",{status:"done"})},"Selesai ",10,J)]),e("li",O,[e("a",{class:_(["nav-link",{active:r.status=="cancel"}]),href:a.route("user.order.index",{status:"cancel"})},"Dibatalkan ",10,Q)])]),e("div",W,[i(v,{gutter:12},{default:t(()=>[i(m,{lg:12},{default:t(()=>[i(x,{modelValue:r.searchTerms,"onUpdate:modelValue":o[0]||(o[0]=s=>r.searchTerms=s),class:"w-75 m-2",placeholder:"Cari Pesanan"},{prefix:t(()=>[X]),_:1},8,["modelValue"])]),_:1}),i(m,{lg:12,class:"d-flex float-end my-auto"},{default:t(()=>[e("div",Z,[e("div",$,[e("span",null,c(r.from)+"-"+c(r.to)+"/"+c(r.total),1)]),e("div",ee,[i(f,{type:"primary",size:"small"},{default:t(()=>[se]),_:1}),i(f,{type:"primary",size:"small",plain:""},{default:t(()=>[te]),_:1})])])]),_:1})]),_:1})])]),r.data.length?(l(!0),k(w,{key:0},C(r.data,s=>(l(),k("div",{class:"block rounded block-bordered mb-2",key:s.id},[e("div",ae,[e("h3",oe,c(y.format_date(s.created_at)),1),e("div",ne,[e("div",re,[s.state=="pending"?(l(),u(h,{key:0,class:"ml-2",type:"warning"},{default:t(()=>[d("Menunggu Konfirmasi")]),_:1})):s.state=="shipping"?(l(),u(h,{key:1,class:"ml-2",type:"info"},{default:t(()=>[d("Dikirim")]),_:1})):s.state=="done"?(l(),u(h,{key:2,class:"ml-2",type:"success"},{default:t(()=>[d("Selesai")]),_:1})):s.state=="cancel"?(l(),u(h,{key:3,class:"ml-2",type:"danger"},{default:t(()=>[d("Batal")]),_:1})):p("",!0)])])]),e("div",ie,[i(v,{gutter:20},{default:t(()=>[i(m,{lg:18},{default:t(()=>[i(v,{gutter:20},{default:t(()=>[i(m,{lg:3},{default:t(()=>[e("img",{src:s.lines[0].product.main_image,class:"img-fluid"},null,8,le)]),_:2},1024),i(m,{lg:18,class:"d-flex"},{default:t(()=>[e("div",ce,[e("div",de,[d(c(s.lines[0].product.name)+" ",1),s.lines[0].variant.name?(l(),k(w,{key:0},[d(" - "+c(s.lines[0].variant.name),1)],64)):p("",!0)]),e("div",ue,c(s.lines[0].qty)+" x "+c(a.currency(s.lines[0].price)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024),i(m,{lg:6,class:"d-flex"},{default:t(()=>[e("div",me,[_e,e("div",pe,c(a.currency(s.grand_total)),1)])]),_:2},1024)]),_:2},1024)]),e("div",fe,[s.state=="shipped"?(l(),u(f,{key:0,type:"primary",onClick:T(E=>y.receive(s.id),["prevent"])},{default:t(()=>[d(" Terima Pesanan ")]),_:2},1032,["onClick"])):p("",!0),e("a",{href:a.route("user.order.show",{id:s.id}),class:"ep-button ep-button--primary is-plain"}," Detail Pesanan ",8,he),s.payment_status=="unpaid"?(l(),u(f,{key:1,type:"primary",onClick:E=>y.payment(s)},{default:t(()=>[d(" Bayar Sekarang ")]),_:2},1032,["onClick"])):p("",!0)])]))),128)):p("",!0)]),_:1})}const Ve=D(Y,[["render",ge]]);export{Ve as default};
