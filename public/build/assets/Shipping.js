import x from"./ShippingAddress.js";import{_ as C,L as f,o as l,B as g,C as n,a as t,G as r,c as u,E,F as p,e as y,D as c,a5 as A,H as B}from"./id.js";import{E as L}from"./index21.js";import{E as S}from"./index8.js";import{E as j}from"./index9.js";import"./index27.js";import"./index28.js";import"./scroll.js";import"./event.js";import"./index22.js";import"./typescript.js";import"./index23.js";import"./_Uint8Array.js";import"./_initCloneObject.js";import"./index29.js";import"./index7.js";const P={components:{ShippingAddress:x},props:{cart:Array,errors:Object},data(){return{product:[],var1:null,var2:null,selected:[],selectAll:!1,address:{},shippingCost:0,showAll:!0}},computed:{totalProduct(){var s=0;return this.selected.forEach((e,o)=>{s+=e.qty}),s},totalHarga(){var s=0;return this.cart.forEach((e,o)=>{s+=e.price*e.qty}),s}},watch:{selectAll:function(s){this.selected=[],s&&this.$page.props.cart.forEach((e,o)=>{this.selected.push(e)})},address(s){if(Object.keys(s).length&&s.distance){let e=(s.distance-5e3)/1e3;this.shippingCost=e*6e3}}},mounted(){this.getAddress()},methods:{payment(){this.$inertia.form({products:this.cart,shipping:this.shippingSelected,delivery_id:this.destination.id}).post(this.route("checkout.payment"),{preserveScroll:!0,onSuccess:()=>{}})},async payment(){try{const s=this;this.isLoading=!0;const e=await axios.post(this.route("checkout.store"),{lines:this.cart,address_id:this.address.id,shipping_cost:this.shippingCost,total:this.totalHarga});if(e.status==200){const o=e.data;snap.pay(o.payment_ref,{onSuccess:function(h){L({type:"success",message:"Pembayaran Berhasil"}),s.updatePayment("paid",o.id)},onPending:function(h){window.location.href=s.route("user.order.show",{id:o.id})},onError:function(h){window.location.href=s.route("user.order.show",{id:o.id})},onClose:function(){window.location.href=s.route("user.order.show",{id:o.id})}})}this.isLoading=!1}catch(s){console.error(s)}},async getAddress(){try{this.isLoading=!0;const s=await axios.get("/user/alamat/data",{params:{main:1}});s.status==200&&(this.address=s.data),this.isLoading=!1}catch(s){console.error(s)}},async updatePayment(s,e){try{this.isLoading=!0,(await axios.post(this.route("user.order.state",{id:e}),{status:s})).status==200&&(window.location.href=this.route("user.order.show",{id:e})),this.isLoading=!1}catch(o){console.error(o)}}}},V={class:"content"},H=t("div",{class:"content-heading pt-0 mb-0 border-0 font-size-md"}," Pesanan Kamu ",-1),q={class:"block block-bordered rounded"},T={class:"block-content p-3"},N=["src"],K={class:"fs-5 fw-bold"},z={class:"fs-sm fw-semibold"},D={class:"fs-5 fw-bold text-end"},F=t("span",{class:"fs-6 fw-semibold"},"Tampilkan Semua",-1),O=t("i",{class:"fa fa-angle-small-down"},null,-1),R=t("span",{class:"fs-6 fw-semibold"},"Tampilkan Lebih Sedikit",-1),G=t("i",{class:"fa fa-angle-small-up"},null,-1),M=t("div",{class:"content-heading d-flex justify-content-between mb-2 py-2"}," Rincian Belanja ",-1),U={class:"block block-bordered rounded"},I={class:"block-content block-content-full"},J={class:"d-flex justify-content-between mb-3"},Q={class:"fs-6"},W={class:"fs-6 fw-bold"},X={class:"d-flex justify-content-between"},Y=t("div",{class:"fs-6"},"Biaya Kirim",-1),Z={class:"fs-6 fw-bold"},$={class:"block-content p-4 border-top border-2x"},ss={class:"d-flex justify-content-between mb-3"},ts=t("div",{class:"fs-5"},"Total Belanja",-1),es={class:"fs-5 fw-bold"};function os(s,e,o,h,i,_){const b=f("shipping-address"),d=S,m=j,w=B,v=f("base-layout");return l(),g(v,null,{default:n(()=>[t("div",V,[r(m,{gutter:20},{default:n(()=>[r(d,{lg:16},{default:n(()=>[r(b,{modelValue:i.address,"onUpdate:modelValue":e[0]||(e[0]=a=>i.address=a)},null,8,["modelValue"]),H,t("div",q,[t("div",T,[(l(!0),u(p,null,E(o.cart,(a,k)=>(l(),u(p,null,[k==0||!i.showAll?(l(),g(m,{key:a.variant_id,class:"mb-2",gutter:10},{default:n(()=>[r(d,{lg:2},{default:n(()=>[t("img",{src:a.product.main_image,class:"img-fluid"},null,8,N)]),_:2},1024),r(d,{lg:14,class:"my-auto"},{default:n(()=>[t("div",K,c(a.product.name),1),t("div",z,c(s.currency(a.price))+" x "+c(a.qty)+" barang",1)]),_:2},1024),r(d,{lg:8,class:"my-auto"},{default:n(()=>[t("div",D,c(s.currency(a.price*a.qty)),1)]),_:2},1024)]),_:2},1024)):y("",!0)],64))),256))]),o.cart.length>1?(l(),u("div",{key:0,class:"block-content p-3 text-center border-top border-bottom border-2",onClick:e[1]||(e[1]=a=>i.showAll=!i.showAll)},[i.showAll?(l(),u(p,{key:0},[F,O],64)):(l(),u(p,{key:1},[R,G],64))])):y("",!0)])]),_:1}),r(d,{lg:8},{default:n(()=>[M,t("div",U,[t("div",I,[t("div",J,[t("div",Q,"Total Harga ("+c(o.cart.length)+" barang)",1),t("div",W,c(s.currency(_.totalHarga)),1)]),t("div",X,[Y,t("div",Z,c(s.currency(i.shippingCost)),1)])]),t("div",$,[t("div",ss,[ts,t("div",es,c(s.currency(_.totalHarga+i.shippingCost)),1)]),r(w,{type:"primary",size:"large",class:"w-100",onClick:_.payment},{default:n(()=>[A(" Lanjut Ke Pembayaran ")]),_:1},8,["onClick"])])])]),_:1})]),_:1})])]),_:1})}const ws=C(P,[["render",os]]);export{ws as default};
